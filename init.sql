# DROP TABLE Real_Location;
# DROP TABLE House_Price;
# DROP TABLE Aggregated_Location;

CREATE TABLE Real_Location
(
    id   INT PRIMARY KEY,
    name VARCHAR(255)
);
CREATE TABLE Aggregated_Location
(
    id          INT PRIMARY KEY,
    description VARCHAR(255)
);
CREATE TABLE House_Price
(
    id                     INT AUTO_INCREMENT,
    price                  FLOAT,
    quarter                INT,
    location_id_real       INT,
    location_id_aggregated INT,
    year                   INT,
    is_real                BOOLEAN,
    PRIMARY KEY (id),
    FOREIGN KEY (location_id_real) REFERENCES Real_Location (id),
    FOREIGN KEY (location_id_aggregated) REFERENCES
        Aggregated_Location (id),
    CHECK ((location_id_real IS NULL) != (location_id_aggregated IS NULL))
);

insert into House_Price (year, quarter, location_id_real, location_id_aggregated, price)
values ('2020', '3', null, '0', '127.09'),
       ('2020', '3', null, '1', '127.77'),
       ('2020', '3', null, '2', '0.0'),
       ('2020', '3', null, '3', '125.65'),
       ('2020', '3', null, '4', '125.68'),
       ('2020', '3', null, '5', '125.65'),
       ('2020', '3', '0', null, '119.62'),
       ('2020', '3', '1', null, '138.81'),
       ('2020', '3', '2', null, '155.4'),
       ('2020', '3', '3', null, '126.24'),
       ('2020', '3', null, '6', '140.3'),
       ('2020', '3', '4', null, '131.08'),
       ('2020', '3', '5', null, '134.55'),
       ('2020', '3', '6', null, '128.56'),
       ('2020', '3', '7', null, '117.8'),
       ('2020', '3', '8', null, '129.75'),
       ('2020', '3', '9', null, '99.8'),
       ('2020', '3', '10', null, '104.21'),
       ('2020', '3', '11', null, '147.08'),
       ('2020', '3', '12', null, '140.85'),
       ('2020', '3', '13', null, '152.97'),
       ('2020', '3', '14', null, '181.59'),
       ('2020', '3', '15', null, '129.81'),
       ('2020', '3', '16', null, '144.59'),
       ('2020', '3', '17', null, '138.71'),
       ('2020', '3', '18', null, '137.06'),
       ('2020', '3', '19', null, '153.61'),
       ('2020', '3', '20', null, '126.38'),
       ('2020', '3', '21', null, '135.65'),
       ('2020', '3', '22', null, '145.93'),
       ('2020', '3', '23', null, '105.79'),
       ('2020', '3', '24', null, '122.95'),
       ('2020', '3', '25', null, '159.19'),
       ('2020', '3', '26', null, '128.18'),
       ('2020', '3', '27', null, '0.0'),
       ('2020', '3', null, '7', '121.15'),
       ('2020', '3', '28', null, '181.8'),
       ('2020', '4', null, '7', '128.84'),
       ('2020', '4', null, '7', '129.53'),
       ('2020', '4', null, '7', '0.0'),
       ('2020', '4', null, '7', '127.41'),
       ('2020', '4', null, '7', '127.45'),
       ('2020', '4', null, '7', '127.41'),
       ('2020', '4', '28', null, '122.23'),
       ('2020', '4', '28', null, '141.23'),
       ('2020', '4', '28', null, '159.5'),
       ('2020', '4', '28', null, '128.98'),
       ('2020', '4', null, '7', '144.3'),
       ('2020', '4', '28', null, '136.01'),
       ('2020', '4', '28', null, '136.28'),
       ('2020', '4', '28', null, '127.55'),
       ('2020', '4', '28', null, '119.27'),
       ('2020', '4', '28', null, '132.95'),
       ('2020', '4', '28', null, '100.0'),
       ('2020', '4', '28', null, '109.1'),
       ('2020', '4', '28', null, '147.92'),
       ('2020', '4', '28', null, '146.35'),
       ('2020', '4', '28', null, '160.08'),
       ('2020', '4', '28', null, '179.08'),
       ('2020', '4', '28', null, '133.01'),
       ('2020', '4', '28', null, '147.44'),
       ('2020', '4', '28', null, '139.66'),
       ('2020', '4', '28', null, '138.42'),
       ('2020', '4', '28', null, '157.69'),
       ('2020', '4', '28', null, '127.97'),
       ('2020', '4', '28', null, '138.43'),
       ('2020', '4', '28', null, '147.53'),
       ('2020', '4', '28', null, '106.95'),
       ('2020', '4', '28', null, '124.99'),
       ('2020', '4', '28', null, '162.62'),
       ('2020', '4', '28', null, '128.54'),
       ('2020', '4', '28', null, '0.0'),
       ('2020', '4', null, '7', '0.0'),
       ('2020', '4', '28', null, '191.9'),
       ('2021', '1', null, '7', '131.2'),
       ('2021', '1', null, '7', '131.91'),
       ('2021', '1', null, '7', '0.0'),
       ('2021', '1', null, '7', '129.2'),
       ('2021', '1', null, '7', '129.24'),
       ('2021', '1', null, '7', '129.2'),
       ('2021', '1', '28', null, '123.49'),
       ('2021', '1', '28', null, '145.72'),
       ('2021', '1', '28', null, '168.9'),
       ('2021', '1', '28', null, '135.02'),
       ('2021', '1', null, '7', '146.3'),
       ('2021', '1', '28', null, '144.93'),
       ('2021', '1', '28', null, '138.34'),
       ('2021', '1', '28', null, '128.12'),
       ('2021', '1', '28', null, '120.15'),
       ('2021', '1', '28', null, '134.19'),
       ('2021', '1', '28', null, '101.1'),
       ('2021', '1', '28', null, '102.84'),
       ('2021', '1', '28', null, '149.97'),
       ('2021', '1', '28', null, '153.69'),
       ('2021', '1', '28', null, '167.17'),
       ('2021', '1', '28', null, '195.95'),
       ('2021', '1', '28', null, '130.82'),
       ('2021', '1', '28', null, '153.34'),
       ('2021', '1', '28', null, '144.7'),
       ('2021', '1', '28', null, '141.16'),
       ('2021', '1', '28', null, '161.7'),
       ('2021', '1', '28', null, '131.45'),
       ('2021', '1', '28', null, '142.65'),
       ('2021', '1', '28', null, '145.81'),
       ('2021', '1', '28', null, '108.57'),
       ('2021', '1', '28', null, '128.9'),
       ('2021', '1', '28', null, '166.26'),
       ('2021', '1', '28', null, '134.2'),
       ('2021', '1', '28', null, '0.0'),
       ('2021', '1', null, '7', '0.0'),
       ('2021', '1', '28', null, '205.1'),
       ('2021', '2', null, '7', '134.88'),
       ('2021', '2', null, '7', '135.6'),
       ('2021', '2', null, '7', '0.0'),
       ('2021', '2', null, '7', '132.72'),
       ('2021', '2', null, '7', '132.77'),
       ('2021', '2', null, '7', '132.72'),
       ('2021', '2', '28', null, '125.71'),
       ('2021', '2', '28', null, '146.23'),
       ('2021', '2', '28', null, '177.6'),
       ('2021', '2', '28', null, '138.87'),
       ('2021', '2', null, '7', '151.8'),
       ('2021', '2', '28', null, '148.69'),
       ('2021', '2', '28', null, '141.65'),
       ('2021', '2', '28', null, '131.15'),
       ('2021', '2', '28', null, '122.12'),
       ('2021', '2', '28', null, '139.03'),
       ('2021', '2', '28', null, '102.8'),
       ('2021', '2', '28', null, '104.23'),
       ('2021', '2', '28', null, '159.51'),
       ('2021', '2', '28', null, '158.87'),
       ('2021', '2', '28', null, '168.74'),
       ('2021', '2', '28', null, '204.4'),
       ('2021', '2', '28', null, '134.42'),
       ('2021', '2', '28', null, '159.47'),
       ('2021', '2', '28', null, '150.95'),
       ('2021', '2', '28', null, '145.5'),
       ('2021', '2', '28', null, '166.4'),
       ('2021', '2', '28', null, '133.61'),
       ('2021', '2', '28', null, '149.21'),
       ('2021', '2', '28', null, '150.57'),
       ('2021', '2', '28', null, '111.18'),
       ('2021', '2', '28', null, '133.44'),
       ('2021', '2', '28', null, '174.99'),
       ('2021', '2', '28', null, '138.47'),
       ('2021', '2', '28', null, '0.0'),
       ('2021', '2', null, '7', '0.0'),
       ('2021', '2', '28', null, '223.4'),
       ('2021', '3', null, '7', '139.09'),
       ('2021', '3', null, '7', '139.84'),
       ('2021', '3', null, '7', '0.0'),
       ('2021', '3', null, '7', '137.01'),
       ('2021', '3', null, '7', '137.05'),
       ('2021', '3', null, '7', '137.01'),
       ('2021', '3', '28', null, '129.42'),
       ('2021', '3', '28', null, '150.9'),
       ('2021', '3', '28', null, '189.8'),
       ('2021', '3', '28', null, '140.44'),
       ('2021', '3', null, '7', '158.2'),
       ('2021', '3', '28', null, '153.71'),
       ('2021', '3', '28', null, '148.81'),
       ('2021', '3', '28', null, '133.92'),
       ('2021', '3', '28', null, '126.11'),
       ('2021', '3', '28', null, '141.44'),
       ('2021', '3', '28', null, '103.9'),
       ('2021', '3', '28', null, '106.8'),
       ('2021', '3', '28', null, '165.31'),
       ('2021', '3', '28', null, '167.44'),
       ('2021', '3', '28', null, '173.22'),
       ('2021', '3', '28', null, '211.94'),
       ('2021', '3', '28', null, '137.52'),
       ('2021', '3', '28', null, '168.82'),
       ('2021', '3', '28', null, '156.26'),
       ('2021', '3', '28', null, '149.28'),
       ('2021', '3', '28', null, '171.3'),
       ('2021', '3', '28', null, '133.78'),
       ('2021', '3', '28', null, '153.15'),
       ('2021', '3', '28', null, '157.66'),
       ('2021', '3', '28', null, '110.92'),
       ('2021', '3', '28', null, '136.89'),
       ('2021', '3', '28', null, '180.92'),
       ('2021', '3', '28', null, '139.48'),
       ('2021', '3', '28', null, '0.0'),
       ('2021', '3', null, '7', '0.0'),
       ('2021', '3', '28', null, '246.5'),
       ('2021', '4', null, '7', '141.99'),
       ('2021', '4', null, '7', '142.75'),
       ('2021', '4', null, '7', '0.0'),
       ('2021', '4', null, '7', '139.57'),
       ('2021', '4', null, '7', '139.62'),
       ('2021', '4', null, '7', '139.57'),
       ('2021', '4', '28', null, '129.61'),
       ('2021', '4', '28', null, '154.48'),
       ('2021', '4', '28', null, '200.6'),
       ('2021', '4', '28', null, '137.57'),
       ('2021', '4', null, '7', '162.5'),
       ('2021', '4', '28', null, '163.78'),
       ('2021', '4', '28', null, '155.1'),
       ('2021', '4', '28', null, '135.58'),
       ('2021', '4', '28', null, '127.52'),
       ('2021', '4', '28', null, '144.99'),
       ('2021', '4', '28', null, '104.0'),
       ('2021', '4', '28', null, '103.44'),
       ('2021', '4', '28', null, '171.79'),
       ('2021', '4', '28', null, '175.36'),
       ('2021', '4', '28', null, '179.48'),
       ('2021', '4', '28', null, '219.86'),
       ('2021', '4', '28', null, '138.99'),
       ('2021', '4', '28', null, '175.2'),
       ('2021', '4', '28', null, '161.14'),
       ('2021', '4', '28', null, '155.15'),
       ('2021', '4', '28', null, '175.96'),
       ('2021', '4', '28', null, '137.51'),
       ('2021', '4', '28', null, '160.26'),
       ('2021', '4', '28', null, '163.28'),
       ('2021', '4', '28', null, '111.12'),
       ('2021', '4', '28', null, '138.62'),
       ('2021', '4', '28', null, '188.09'),
       ('2021', '4', '28', null, '138.48'),
       ('2021', '4', '28', null, '0.0'),
       ('2021', '4', null, '7', '0.0'),
       ('2021', '4', '28', null, '306.6'),
       ('2022', '1', null, '7', '144.84'),
       ('2022', '1', null, '7', '145.62'),
       ('2022', '1', null, '7', '0.0'),
       ('2022', '1', null, '7', '141.81'),
       ('2022', '1', null, '7', '141.89'),
       ('2022', '1', null, '7', '141.81'),
       ('2022', '1', '28', null, '131.47'),
       ('2022', '1', '28', null, '162.52'),
       ('2022', '1', '28', null, '210.0'),
       ('2022', '1', '28', null, '140.64'),
       ('2022', '1', null, '7', '163.2'),
       ('2022', '1', '28', null, '175.37'),
       ('2022', '1', '28', null, '159.07'),
       ('2022', '1', '28', null, '139.05'),
       ('2022', '1', '28', null, '128.6'),
       ('2022', '1', '28', null, '152.25'),
       ('2022', '1', '28', null, '105.7'),
       ('2022', '1', '28', null, '103.95'),
       ('2022', '1', '28', null, '176.06'),
       ('2022', '1', '28', null, '183.12'),
       ('2022', '1', '28', null, '184.34'),
       ('2022', '1', '28', null, '241.42'),
       ('2022', '1', '28', null, '139.69'),
       ('2022', '1', '28', null, '182.98'),
       ('2022', '1', '28', null, '165.94'),
       ('2022', '1', '28', null, '160.3'),
       ('2022', '1', '28', null, '182.64'),
       ('2022', '1', '28', null, '139.82'),
       ('2022', '1', '28', null, '166.78'),
       ('2022', '1', '28', null, '166.46'),
       ('2022', '1', '28', null, '112.23'),
       ('2022', '1', '28', null, '142.19'),
       ('2022', '1', '28', null, '196.06'),
       ('2022', '1', '28', null, '144.62'),
       ('2022', '1', '28', null, '0.0'),
       ('2022', '1', null, '7', '0.0'),
       ('2022', '1', '28', null, '430.8'),
       ('2022', '2', null, '7', '148.12'),
       ('2022', '2', null, '7', '148.91'),
       ('2022', '2', null, '7', '0.0'),
       ('2022', '2', null, '7', '144.91'),
       ('2022', '2', null, '7', '145.01'),
       ('2022', '2', null, '7', '144.91'),
       ('2022', '2', '28', null, '133.17'),
       ('2022', '2', '28', null, '167.58'),
       ('2022', '2', '28', null, '217.2'),
       ('2022', '2', '28', null, '142.51'),
       ('2022', '2', null, '7', '166.6'),
       ('2022', '2', '28', null, '189.36'),
       ('2022', '2', '28', null, '161.89'),
       ('2022', '2', '28', null, '141.71'),
       ('2022', '2', '28', null, '130.83'),
       ('2022', '2', '28', null, '157.94'),
       ('2022', '2', '28', null, '108.1'),
       ('2022', '2', '28', null, '106.35'),
       ('2022', '2', '28', null, '185.56'),
       ('2022', '2', '28', null, '193.91'),
       ('2022', '2', '28', null, '188.4'),
       ('2022', '2', '28', null, '255.23'),
       ('2022', '2', '28', null, '144.63'),
       ('2022', '2', '28', null, '188.33'),
       ('2022', '2', '28', null, '169.47'),
       ('2022', '2', '28', null, '163.5'),
       ('2022', '2', '28', null, '188.31'),
       ('2022', '2', '28', null, '144.94'),
       ('2022', '2', '28', null, '172.56'),
       ('2022', '2', '28', null, '175.62'),
       ('2022', '2', '28', null, '113.81'),
       ('2022', '2', '28', null, '142.86'),
       ('2022', '2', '28', null, '211.23'),
       ('2022', '2', '28', null, '147.68'),
       ('2022', '2', '28', null, '0.0'),
       ('2022', '2', null, '7', '0.0'),
       ('2022', '2', '28', null, '582.4'),
       ('2022', '3', null, '7', '149.2'),
       ('2022', '3', null, '7', '150.0'),
       ('2022', '3', null, '7', '0.0'),
       ('2022', '3', null, '7', '146.07'),
       ('2022', '3', null, '7', '146.19'),
       ('2022', '3', null, '7', '146.07'),
       ('2022', '3', '28', null, '136.33'),
       ('2022', '3', '28', null, '174.43'),
       ('2022', '3', '28', null, '219.4'),
       ('2022', '3', '28', null, '137.48'),
       ('2022', '3', null, '7', '165.0'),
       ('2022', '3', '28', null, '190.94'),
       ('2022', '3', '28', null, '166.47'),
       ('2022', '3', '28', null, '144.15'),
       ('2022', '3', '28', null, '134.34'),
       ('2022', '3', '28', null, '162.44'),
       ('2022', '3', '28', null, '106.9'),
       ('2022', '3', '28', null, '112.51'),
       ('2022', '3', '28', null, '187.79'),
       ('2022', '3', '28', null, '199.7'),
       ('2022', '3', '28', null, '192.3'),
       ('2022', '3', '28', null, '261.44'),
       ('2022', '3', '28', null, '146.23'),
       ('2022', '3', '28', null, '189.33'),
       ('2022', '3', '28', null, '174.91'),
       ('2022', '3', '28', null, '167.38'),
       ('2022', '3', '28', null, '193.82'),
       ('2022', '3', '28', null, '143.2'),
       ('2022', '3', '28', null, '176.67'),
       ('2022', '3', '28', null, '180.61'),
       ('2022', '3', '28', null, '112.41'),
       ('2022', '3', '28', null, '138.46'),
       ('2022', '3', '28', null, '224.47'),
       ('2022', '3', '28', null, '147.93'),
       ('2022', '3', '28', null, '0.0'),
       ('2022', '3', null, '7', '0.0'),
       ('2022', '3', '28', null, '712.5'),
       ('2022', '4', null, '7', '147.03'),
       ('2022', '4', null, '7', '147.82'),
       ('2022', '4', null, '7', '0.0'),
       ('2022', '4', null, '7', '143.57'),
       ('2022', '4', null, '7', '143.76'),
       ('2022', '4', null, '7', '143.57'),
       ('2022', '4', '28', null, '135.76'),
       ('2022', '4', '28', null, '175.14'),
       ('2022', '4', '28', null, '214.5'),
       ('2022', '4', '28', null, '128.58'),
       ('2022', '4', null, '7', '156.7'),
       ('2022', '4', '28', null, '191.38'),
       ('2022', '4', '28', null, '168.52'),
       ('2022', '4', '28', null, '142.99'),
       ('2022', '4', '28', null, '133.73'),
       ('2022', '4', '28', null, '170.11'),
       ('2022', '4', '28', null, '106.9'),
       ('2022', '4', '28', null, '108.03'),
       ('2022', '4', '28', null, '187.44'),
       ('2022', '4', '28', null, '203.46'),
       ('2022', '4', '28', null, '189.53'),
       ('2022', '4', '28', null, '256.24'),
       ('2022', '4', '28', null, '147.24'),
       ('2022', '4', '28', null, '184.42'),
       ('2022', '4', '28', null, '173.86'),
       ('2022', '4', '28', null, '169.64'),
       ('2022', '4', '28', null, '195.91'),
       ('2022', '4', '28', null, '146.83'),
       ('2022', '4', '28', null, '178.41'),
       ('2022', '4', '28', null, '179.18'),
       ('2022', '4', '28', null, '108.56'),
       ('2022', '4', '28', null, '133.49'),
       ('2022', '4', '28', null, '227.61'),
       ('2022', '4', '28', null, '142.62'),
       ('2022', '4', '28', null, '0.0'),
       ('2022', '4', null, '7', '0.0'),
       ('2022', '4', '28', null, '821.2');

